{{define "documents/partials/document_card.html"}}
<div class="bg-slate-700 rounded-lg shadow-lg border border-slate-600 hover:border-slate-500 transition-all duration-200 group relative" 
     id="document-{{.ID}}">
  <div class="p-4">
    <div class="flex items-start justify-between gap-3 mb-3">
      <div class="flex-1 min-w-0">
        <h3 class="font-semibold text-white group-hover:text-primary transition-colors truncate">
          {{.JobTitle | html}}
        </h3>
        <p class="text-sm text-gray-400 truncate">{{.CompanyName | html}}</p>
      </div>
      
      <div class="relative flex-shrink-0">
        <button type="button"
                onclick="toggleDropdown('{{.ID}}')"
                class="p-2 rounded-md text-gray-300 hover:text-white hover:bg-slate-600 transition-colors"
                aria-label="Document actions"
                aria-expanded="false"
                aria-haspopup="true">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
          </svg>
        </button>
        
        <div id="dropdown-{{.ID}}"
             class="hidden absolute right-0 top-8 w-48 bg-slate-800 rounded-md shadow-xl border border-slate-600 z-10"
             role="menu"
             aria-orientation="vertical"
             aria-labelledby="document-menu-button-{{.ID}}">
          <a href="/jobs/{{.JobID}}/details" 
             role="menuitem"
             onclick="toggleDropdown('{{.ID}}')"
             class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-300 hover:bg-slate-700 hover:text-white transition-colors rounded-t-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            View Job
          </a>
          
          <button onclick="toggleDropdown('{{.ID}}'); downloadDocument({{.ID}}, '{{.DocumentType}}')" 
                  role="menuitem"
                  class="flex items-center gap-3 px-4 py-2.5 text-sm text-gray-300 hover:bg-slate-700 hover:text-white transition-colors w-full text-left">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            Download
          </button>
          
          <hr class="border-slate-600 my-1" role="separator">
          
          <button class="flex items-center gap-3 px-4 py-2.5 text-sm text-red-400 hover:bg-slate-700 hover:text-red-300 transition-colors w-full text-left rounded-b-md"
                  role="menuitem"
                  onclick="toggleDropdown('{{.ID}}')"
                  _="on click 
                     js window.setDeleteItem({url: '/documents/{{.ID}}', method: 'DELETE', type: 'document'}) end
                     put 'Are you sure you want to delete this document? This action cannot be undone.' into #delete-message
                     remove .hidden from #delete-modal-shared">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
            Delete
          </button>
        </div>
      </div>
    </div>

    <div class="flex items-center justify-between text-xs">
      <div class="flex items-center gap-2">
        {{if eq .DocumentType "cover_letter"}}
        <span class="flex items-center gap-1.5 text-gray-400">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          <span>Cover Letter</span>
        </span>
        {{else}}
        <span class="flex items-center gap-1.5 text-gray-400">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          <span>Resume</span>
        </span>
        {{end}}
        
        {{if eq .JobStatus "interested"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-blue-900 bg-opacity-30 text-blue-400 rounded">Interested</span>
        {{else if eq .JobStatus "applied"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-green-900 bg-opacity-30 text-green-400 rounded">Applied</span>
        {{else if eq .JobStatus "interviewing"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-yellow-900 bg-opacity-30 text-yellow-400 rounded">Interview</span>
        {{else if eq .JobStatus "offer_received"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-purple-900 bg-opacity-30 text-purple-400 rounded">Offer</span>
        {{else if eq .JobStatus "rejected"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-red-900 bg-opacity-30 text-red-400 rounded">Rejected</span>
        {{else if eq .JobStatus "not_interested"}}
        <span class="px-1.5 py-0.5 text-xs font-medium bg-gray-800 bg-opacity-50 text-gray-500 rounded">Passed</span>
        {{end}}
      </div>
      
      <span class="text-gray-500 utc-time" data-utc="{{.CreatedAt.Format "2006-01-02T15:04:05Z07:00"}}" data-format="date">
        {{.CreatedAt.Format "Jan 2"}}
      </span>
    </div>
  </div>
</div>
{{end}}
